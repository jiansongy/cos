<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="CreatorOS - AIé€‰é¢˜å¼•æ“">
  <title>AIé€‰é¢˜å¼•æ“ - CreatorOS</title>
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect width='32' height='32' rx='8' fill='%23FF2D55'/%3E%3Ctext x='16' y='21' font-family='system-ui' font-size='12' font-weight='bold' fill='white' text-anchor='middle'%3ECO%3C/text%3E%3C/svg%3E">
  <link rel="stylesheet" href="assets/css/styles.css">
  <style>
    .engine-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: var(--space-6);
      flex-wrap: wrap;
      gap: var(--space-4);
    }
    
    .engine-status {
      display: flex;
      align-items: center;
      gap: var(--space-3);
    }
    
    .status-indicator {
      display: flex;
      align-items: center;
      gap: var(--space-2);
      padding: var(--space-2) var(--space-4);
      background: rgba(0, 212, 170, 0.1);
      border: 1px solid rgba(0, 212, 170, 0.3);
      border-radius: var(--radius-full);
      font-size: var(--text-sm);
      color: var(--color-secondary);
    }
    
    .status-indicator.generating {
      background: rgba(255, 149, 0, 0.1);
      border-color: rgba(255, 149, 0, 0.3);
      color: var(--color-warning);
    }
    
    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: currentColor;
      animation: pulse 2s ease-in-out infinite;
    }
    
    .workflow-card {
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-2xl);
      padding: var(--space-6);
      margin-bottom: var(--space-6);
    }
    
    .workflow-steps {
      display: flex;
      justify-content: space-between;
      position: relative;
      margin-bottom: var(--space-6);
    }
    
    .workflow-steps::before {
      content: '';
      position: absolute;
      top: 20px;
      left: 60px;
      right: 60px;
      height: 2px;
      background: var(--border-color);
    }
    
    .workflow-step {
      display: flex;
      flex-direction: column;
      align-items: center;
      position: relative;
      z-index: 1;
    }
    
    .workflow-step-icon {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: var(--bg-elevated);
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: var(--space-2);
      transition: all var(--transition-base);
    }
    
    .workflow-step.active .workflow-step-icon {
      background: var(--color-primary);
    }
    
    .workflow-step.completed .workflow-step-icon {
      background: var(--color-secondary);
    }
    
    .workflow-step-label {
      font-size: var(--text-xs);
      color: var(--text-muted);
    }
    
    .workflow-step.active .workflow-step-label,
    .workflow-step.completed .workflow-step-label {
      color: var(--text-primary);
      font-weight: 500;
    }
    
    .generate-section {
      text-align: center;
      padding: var(--space-8);
      background: var(--bg-surface);
      border-radius: var(--radius-xl);
    }
    
    .generate-btn {
      padding: var(--space-4) var(--space-10);
      font-size: var(--text-lg);
      background: linear-gradient(135deg, var(--color-primary), var(--color-accent));
      border: none;
      border-radius: var(--radius-xl);
      color: white;
      font-weight: 600;
      cursor: pointer;
      transition: all var(--transition-base);
    }
    
    .generate-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 10px 30px rgba(255, 45, 85, 0.4);
    }
    
    .generate-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }
    
    .topics-grid {
      display: grid;
      gap: var(--space-4);
    }
    
    .topic-card {
      background: var(--bg-card);
      border: 2px solid var(--border-color);
      border-radius: var(--radius-xl);
      padding: var(--space-6);
      cursor: pointer;
      transition: all var(--transition-base);
    }
    
    .topic-card:hover {
      border-color: var(--color-primary);
      transform: translateY(-2px);
    }
    
    .topic-card.selected {
      border-color: var(--color-secondary);
      background: rgba(0, 212, 170, 0.05);
    }
    
    .topic-card-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: var(--space-4);
    }
    
    .topic-badge-group {
      display: flex;
      gap: var(--space-2);
    }
    
    .topic-score-badge {
      display: inline-flex;
      align-items: center;
      gap: var(--space-1);
      padding: var(--space-1) var(--space-3);
      border-radius: var(--radius-full);
      font-size: var(--text-sm);
      font-weight: 600;
    }
    
    .score-high {
      background: rgba(0, 212, 170, 0.1);
      color: var(--color-secondary);
    }
    
    .score-medium {
      background: rgba(255, 149, 0, 0.1);
      color: var(--color-warning);
    }
    
    .score-low {
      background: rgba(255, 59, 48, 0.1);
      color: var(--color-danger);
    }
    
    .topic-type-badge {
      padding: var(--space-1) var(--space-3);
      background: rgba(88, 86, 214, 0.1);
      border-radius: var(--radius-full);
      font-size: var(--text-xs);
      color: var(--color-accent);
    }
    
    .topic-event {
      font-size: var(--text-sm);
      color: var(--text-secondary);
      margin-bottom: var(--space-2);
    }
    
    .topic-title {
      font-size: var(--text-lg);
      font-weight: 600;
      margin-bottom: var(--space-3);
      line-height: 1.4;
    }
    
    .topic-angle {
      font-size: var(--text-sm);
      color: var(--text-muted);
      margin-bottom: var(--space-4);
      padding-left: var(--space-4);
      border-left: 2px solid var(--color-accent);
    }
    
    .topic-scores {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: var(--space-2);
      padding-top: var(--space-4);
      border-top: 1px solid var(--border-color);
    }
    
    .score-item {
      text-align: center;
    }
    
    .score-item-value {
      font-size: var(--text-lg);
      font-weight: 600;
      color: var(--color-primary);
    }
    
    .score-item-label {
      font-size: var(--text-xs);
      color: var(--text-muted);
    }
    
    .topic-actions {
      display: flex;
      gap: var(--space-3);
      margin-top: var(--space-4);
    }
    
    .empty-state {
      text-align: center;
      padding: var(--space-12);
      color: var(--text-secondary);
    }
    
    .empty-state-icon {
      font-size: 4rem;
      margin-bottom: var(--space-4);
      opacity: 0.5;
    }
    
    .filter-bar {
      display: flex;
      gap: var(--space-3);
      margin-bottom: var(--space-6);
      flex-wrap: wrap;
    }
    
    .filter-chip {
      padding: var(--space-2) var(--space-4);
      background: var(--bg-surface);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-full);
      font-size: var(--text-sm);
      cursor: pointer;
      transition: all var(--transition-base);
    }
    
    .filter-chip:hover {
      border-color: var(--color-primary);
    }
    
    .filter-chip.active {
      background: rgba(255, 45, 85, 0.1);
      border-color: var(--color-primary);
      color: var(--color-primary);
    }
    
    /* çˆ†æ¬¾å…ƒç´ é€‰æ‹©å™¨æ ·å¼ */
    .viral-elements-card {
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-2xl);
      padding: var(--space-6);
      margin-bottom: var(--space-6);
    }
    
    .viral-elements-title {
      font-size: var(--text-lg);
      font-weight: 600;
      margin-bottom: var(--space-2);
      display: flex;
      align-items: center;
      gap: var(--space-2);
    }
    
    .viral-elements-subtitle {
      font-size: var(--text-sm);
      color: var(--text-muted);
      margin-bottom: var(--space-4);
    }
    
    .viral-elements-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: var(--space-3);
    }
    
    @media (min-width: 768px) {
      .viral-elements-grid {
        grid-template-columns: repeat(4, 1fr);
      }
    }
    
    .viral-element-chip {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: var(--space-2);
      padding: var(--space-4);
      background: var(--bg-surface);
      border: 2px solid var(--border-color);
      border-radius: var(--radius-xl);
      cursor: pointer;
      transition: all var(--transition-base);
      text-align: center;
    }
    
    .viral-element-chip:hover {
      border-color: var(--color-primary);
      transform: translateY(-2px);
    }
    
    .viral-element-chip.selected {
      border-color: var(--color-secondary);
      background: rgba(0, 212, 170, 0.1);
    }
    
    .viral-element-icon {
      font-size: var(--text-2xl);
    }
    
    .viral-element-name {
      font-weight: 600;
      font-size: var(--text-sm);
    }
    
    .viral-element-desc {
      font-size: var(--text-xs);
      color: var(--text-muted);
      line-height: 1.4;
    }
    
    /* é€‰é¢˜å‡çº§é¢æ¿ */
    .topic-upgrade-panel {
      background: linear-gradient(135deg, rgba(88, 86, 214, 0.1), rgba(255, 45, 85, 0.1));
      border: 1px solid rgba(88, 86, 214, 0.2);
      border-radius: var(--radius-2xl);
      padding: var(--space-6);
      margin-bottom: var(--space-6);
      display: none;
    }
    
    .topic-upgrade-panel.active {
      display: block;
    }
    
    .upgrade-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: var(--space-4);
    }
    
    .upgrade-title {
      font-size: var(--text-lg);
      font-weight: 600;
    }
    
    .upgrade-comparison {
      display: grid;
      grid-template-columns: 1fr auto 1fr;
      gap: var(--space-4);
      align-items: center;
      margin-bottom: var(--space-4);
    }
    
    @media (max-width: 640px) {
      .upgrade-comparison {
        grid-template-columns: 1fr;
      }
    }
    
    .upgrade-before, .upgrade-after {
      background: var(--bg-card);
      border-radius: var(--radius-xl);
      padding: var(--space-4);
    }
    
    .upgrade-before {
      border: 2px solid rgba(255, 149, 0, 0.3);
    }
    
    .upgrade-after {
      border: 2px solid rgba(0, 212, 170, 0.3);
    }
    
    .upgrade-label {
      font-size: var(--text-xs);
      color: var(--text-muted);
      margin-bottom: var(--space-2);
    }
    
    .upgrade-topic {
      font-weight: 600;
      margin-bottom: var(--space-3);
      line-height: 1.4;
    }
    
    .upgrade-score {
      display: flex;
      align-items: center;
      gap: var(--space-2);
    }
    
    .score-bar {
      flex: 1;
      height: 8px;
      background: var(--bg-elevated);
      border-radius: var(--radius-full);
      overflow: hidden;
    }
    
    .score-bar-fill {
      height: 100%;
      border-radius: var(--radius-full);
      transition: width 0.5s ease;
    }
    
    .score-bar-fill.low {
      background: var(--color-warning);
    }
    
    .score-bar-fill.high {
      background: var(--color-secondary);
    }
    
    .score-number {
      font-weight: 700;
      font-size: var(--text-lg);
      min-width: 50px;
      text-align: right;
    }
    
    .score-number.low {
      color: var(--color-warning);
    }
    
    .score-number.high {
      color: var(--color-secondary);
    }
    
    .upgrade-arrow {
      font-size: var(--text-2xl);
      color: var(--color-primary);
    }
    
    @media (max-width: 640px) {
      .upgrade-arrow {
        transform: rotate(90deg);
      }
    }
    
    .upgrade-elements-used {
      display: flex;
      flex-wrap: wrap;
      gap: var(--space-2);
      margin-top: var(--space-3);
    }
    
    .element-tag {
      padding: var(--space-1) var(--space-3);
      background: rgba(0, 212, 170, 0.1);
      border-radius: var(--radius-full);
      font-size: var(--text-xs);
      color: var(--color-secondary);
    }
    
    .upgrade-actions {
      display: flex;
      gap: var(--space-3);
      justify-content: center;
    }
    
    .context-card {
      background: var(--bg-surface);
      border-radius: var(--radius-xl);
      padding: var(--space-4);
      margin-bottom: var(--space-6);
    }
    
    .context-title {
      font-size: var(--text-sm);
      font-weight: 600;
      margin-bottom: var(--space-2);
      color: var(--text-secondary);
    }
    
    .context-tags {
      display: flex;
      flex-wrap: wrap;
      gap: var(--space-2);
    }
    
    .context-tag {
      padding: var(--space-1) var(--space-2);
      background: var(--bg-elevated);
      border-radius: var(--radius-sm);
      font-size: var(--text-xs);
      color: var(--text-muted);
    }
    
    @media (max-width: 640px) {
      .workflow-steps::before {
        display: none;
      }
      
      .workflow-steps {
        flex-wrap: wrap;
        gap: var(--space-4);
      }
      
      .topic-scores {
        grid-template-columns: repeat(3, 1fr);
      }
    }
  </style>
</head>
<body>
  <header class="site-header">
    <div class="container">
      <div class="site-header-inner">
        <a href="index.html" class="logo">
          <span class="logo-mark">CO</span>
          <span class="logo-text">CreatorOS</span>
        </a>
        <nav class="desktop-nav">
          <a href="index.html" class="nav-link">ä»ªè¡¨ç›˜</a>
          <a href="setup-wizard.html" class="nav-link">è®¾ç½®</a>
          <a href="topic-engine.html" class="nav-link active">é€‰é¢˜</a>
          <a href="script-generator.html" class="nav-link">è„šæœ¬</a>
          <a href="material-library.html" class="nav-link">ç´ æ</a>
          <a href="publish-center.html" class="nav-link">å‘å¸ƒ</a>
        </nav>
        <button class="mobile-menu-btn" aria-label="Toggle menu">
          <span class="hamburger-line"></span>
          <span class="hamburger-line"></span>
          <span class="hamburger-line"></span>
        </button>
      </div>
    </div>
  </header>
  
  <nav class="mobile-nav">
    <a href="index.html" class="mobile-nav-link">ä»ªè¡¨ç›˜</a>
    <a href="setup-wizard.html" class="mobile-nav-link">è®¾ç½®</a>
    <a href="topic-engine.html" class="mobile-nav-link">é€‰é¢˜</a>
    <a href="script-generator.html" class="mobile-nav-link">è„šæœ¬</a>
    <a href="material-library.html" class="mobile-nav-link">ç´ æ</a>
    <a href="publish-center.html" class="mobile-nav-link">å‘å¸ƒ</a>
  </nav>

  <main class="main-content">
    <div class="container">
      <div class="engine-header" data-animate="fade-in-up">
        <div>
          <h1 class="page-title" style="margin-bottom: var(--space-2);">AIé€‰é¢˜å¼•æ“</h1>
          <p class="text-secondary">åŸºäºä½ çš„åˆ›ä½œè€…æ¡£æ¡ˆï¼Œæ™ºèƒ½ç”Ÿæˆä¸ªæ€§åŒ–é€‰é¢˜</p>
        </div>
        <div class="engine-status">
          <div class="status-indicator" id="status-indicator">
            <span class="status-dot"></span>
            <span id="status-text">å°±ç»ª</span>
          </div>
        </div>
      </div>
      
      <div class="workflow-card" data-animate="fade-in-up">
        <div class="workflow-steps">
          <div class="workflow-step completed" data-step="collect">
            <div class="workflow-step-icon">ğŸ“¥</div>
            <span class="workflow-step-label">é‡‡é›†</span>
          </div>
          <div class="workflow-step" data-step="generate">
            <div class="workflow-step-icon">ğŸ¤–</div>
            <span class="workflow-step-label">ç”Ÿæˆ</span>
          </div>
          <div class="workflow-step" data-step="review">
            <div class="workflow-step-icon">âœ“</div>
            <span class="workflow-step-label">å®¡æ ¸</span>
          </div>
          <div class="workflow-step" data-step="output">
            <div class="workflow-step-icon">ğŸ“¤</div>
            <span class="workflow-step-label">è¾“å‡º</span>
          </div>
        </div>
        
        <div class="generate-section">
          <button class="generate-btn" id="generate-btn" onclick="generateTopics()">
            ğŸ¯ ç”Ÿæˆä»Šæ—¥é€‰é¢˜
          </button>
          <p class="text-muted text-sm mt-4">åŸºäºçƒ­ç‚¹è¶‹åŠ¿ + ä½ çš„æ¡£æ¡ˆé…ç½® + å†å²è¡¨ç°æ•°æ®</p>
        </div>
      </div>
      
      <div class="context-card" data-animate="fade-in-up" id="context-card">
        <div class="context-title">æ­£åœ¨ä½¿ç”¨çš„ä¸Šä¸‹æ–‡ï¼š</div>
        <div class="context-tags" id="context-tags">
          <span class="context-tag">åŠ è½½ä¸­...</span>
        </div>
      </div>
      
      <!-- 8å¤§çˆ†æ¬¾å…ƒç´ é€‰æ‹©å™¨ -->
      <div class="viral-elements-card" data-animate="fade-in-up">
        <div class="viral-elements-title">ğŸ”¥ çˆ†æ¬¾å…ƒç´ å¢å¼º</div>
        <div class="viral-elements-subtitle">é€‰æ‹©1-2ä¸ªå…ƒç´ ï¼Œå°†60åˆ†é€‰é¢˜å‡çº§åˆ°90åˆ†</div>
        <div class="viral-elements-grid" id="viral-elements-grid">
          <div class="viral-element-chip" data-element="æˆæœ¬çš„" onclick="toggleViralElement(this)">
            <span class="viral-element-icon">ğŸ’°</span>
            <span class="viral-element-name">æˆæœ¬çš„</span>
            <span class="viral-element-desc">æé™é¢„ç®—æŒ‘æˆ˜</span>
          </div>
          <div class="viral-element-chip" data-element="äººç¾¤çš„" onclick="toggleViralElement(this)">
            <span class="viral-element-icon">ğŸ‘¥</span>
            <span class="viral-element-name">äººç¾¤çš„</span>
            <span class="viral-element-desc">ç²¾å‡†äººç¾¤é”å®š</span>
          </div>
          <div class="viral-element-chip" data-element="å¥‡è‘©çš„" onclick="toggleViralElement(this)">
            <span class="viral-element-icon">ğŸ¤ª</span>
            <span class="viral-element-name">å¥‡è‘©çš„</span>
            <span class="viral-element-desc">åå¸¸è§„ç°è±¡</span>
          </div>
          <div class="viral-element-chip" data-element="æœ€å·®çš„" onclick="toggleViralElement(this)">
            <span class="viral-element-icon">ğŸ‘€</span>
            <span class="viral-element-name">æœ€å·®çš„</span>
            <span class="viral-element-desc">å›´è§‚å¿ƒç†</span>
          </div>
          <div class="viral-element-chip" data-element="åå·®çš„" onclick="toggleViralElement(this)">
            <span class="viral-element-icon">ğŸ”„</span>
            <span class="viral-element-name">åå·®çš„</span>
            <span class="viral-element-desc">èº«ä»½/è¡Œä¸ºé”™ä½</span>
          </div>
          <div class="viral-element-chip" data-element="æ€€æ—§çš„" onclick="toggleViralElement(this)">
            <span class="viral-element-icon">ğŸ“¼</span>
            <span class="viral-element-name">æ€€æ—§çš„</span>
            <span class="viral-element-desc">é›†ä½“è®°å¿†</span>
          </div>
          <div class="viral-element-chip" data-element="è·å°”è’™çš„" onclick="toggleViralElement(this)">
            <span class="viral-element-icon">ğŸ’“</span>
            <span class="viral-element-name">è·å°”è’™çš„</span>
            <span class="viral-element-desc">æ³¨æ„å°ºåº¦</span>
          </div>
          <div class="viral-element-chip" data-element="å¤´ç‰Œçš„" onclick="toggleViralElement(this)">
            <span class="viral-element-icon">â­</span>
            <span class="viral-element-name">å¤´ç‰Œçš„</span>
            <span class="viral-element-desc">åäººæ•ˆåº”</span>
          </div>
        </div>
      </div>
      
      <!-- é€‰é¢˜å‡çº§é¢æ¿ -->
      <div class="topic-upgrade-panel" id="topic-upgrade-panel" data-animate="fade-in-up">
        <div class="upgrade-header">
          <div class="upgrade-title">âœ¨ é€‰é¢˜å‡çº§é¢„è§ˆ</div>
          <button class="btn btn-ghost" onclick="closeUpgradePanel()">å…³é—­</button>
        </div>
        <div class="upgrade-comparison">
          <div class="upgrade-before">
            <div class="upgrade-label">åŸå§‹é€‰é¢˜</div>
            <div class="upgrade-topic" id="upgrade-original-topic">å¦‚ä½•åšå¥½çŸ­è§†é¢‘</div>
            <div class="upgrade-score">
              <div class="score-bar">
                <div class="score-bar-fill low" id="original-score-bar" style="width: 62%"></div>
              </div>
              <span class="score-number low" id="original-score">62åˆ†</span>
            </div>
          </div>
          <div class="upgrade-arrow">â†’</div>
          <div class="upgrade-after">
            <div class="upgrade-label">å‡çº§åé€‰é¢˜</div>
            <div class="upgrade-topic" id="upgrade-enhanced-topic">ç¨‹åºå‘˜0æˆæœ¬è½¬å‹çŸ­è§†é¢‘,3ä¸ªæœˆç²‰ä¸ç ´10ä¸‡</div>
            <div class="upgrade-score">
              <div class="score-bar">
                <div class="score-bar-fill high" id="enhanced-score-bar" style="width: 87%"></div>
              </div>
              <span class="score-number high" id="enhanced-score">87åˆ†</span>
            </div>
            <div class="upgrade-elements-used" id="upgrade-elements-used">
              <span class="element-tag">æˆæœ¬çš„</span>
              <span class="element-tag">åå·®çš„</span>
            </div>
          </div>
        </div>
        <div class="upgrade-actions">
          <button class="btn btn-primary" onclick="applyUpgrade()">åº”ç”¨å‡çº§</button>
          <button class="btn btn-secondary" onclick="regenerateUpgrade()">é‡æ–°ç”Ÿæˆ</button>
        </div>
      </div>
      
      <div class="filter-bar" data-animate="fade-in-up">
        <button class="filter-chip active" onclick="filterTopics('all', this)">å…¨éƒ¨</button>
        <button class="filter-chip" onclick="filterTopics('high', this)">é«˜åˆ† (80+)</button>
        <button class="filter-chip" onclick="filterTopics('æ™’è¿‡ç¨‹', this)">æ™’è¿‡ç¨‹</button>
        <button class="filter-chip" onclick="filterTopics('æ•™çŸ¥è¯†', this)">æ•™çŸ¥è¯†</button>
        <button class="filter-chip" onclick="filterTopics('è®²æ•…äº‹', this)">è®²æ•…äº‹</button>
        <button class="filter-chip" onclick="filterTopics('èŠè§‚ç‚¹', this)">èŠè§‚ç‚¹</button>
      </div>
      
      <div class="topics-grid" id="topics-grid">
        <div class="empty-state">
          <div class="empty-state-icon">ğŸ¯</div>
          <h3>ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®ç”Ÿæˆé€‰é¢˜</h3>
          <p>AIå°†æ ¹æ®ä½ çš„æ¡£æ¡ˆé…ç½®ç”Ÿæˆ5-10ä¸ªé«˜è´¨é‡é€‰é¢˜</p>
        </div>
      </div>
    </div>
  </main>

  <footer class="site-footer">
    <div class="container">
      <div class="footer-content">
        <a href="index.html" class="logo">
          <span class="logo-mark">CO</span>
          <span class="logo-text">CreatorOS</span>
        </a>
        <nav class="footer-nav">
          <a href="setup-wizard.html" class="footer-link">è®¾ç½®</a>
          <a href="topic-engine.html" class="footer-link">é€‰é¢˜</a>
          <a href="script-generator.html" class="footer-link">è„šæœ¬</a>
          <a href="material-library.html" class="footer-link">ç´ æ</a>
          <a href="publish-center.html" class="footer-link">å‘å¸ƒ</a>
        </nav>
      </div>
    </div>
  </footer>

  <script src="assets/js/main.js"></script>
  <script>
    const sampleTopics = [
      {
        id: 1,
        event: 'æŸå¤§å‚å‘˜å·¥è¢«è£å3ä¸ªæœˆå‰¯ä¸šæ”¶å…¥è¶…è¿‡å·¥èµ„',
        angle: 'ä¸æ˜¯èƒ½åŠ›é—®é¢˜ï¼Œæ˜¯é€‰æ‹©é—®é¢˜â€”â€”ä¸ºä»€ä¹ˆå‰¯ä¸šæ¯”ä¸»ä¸šæ›´å®¹æ˜“æˆåŠŸ',
        title: 'è¢«è£åæ”¶å…¥åè€Œæ¶¨äº†ï¼Ÿè¿™ä¸ªå‰¯ä¸šé€»è¾‘é¢ è¦†äº†æˆ‘',
        type: 'è®²æ•…äº‹',
        score: 92,
        scores: { buyer: 95, monetization: 90, unique: 88, trend: 92, feasibility: 85 }
      },
      {
        id: 2,
        event: 'æ—¶é—´ç®¡ç†ç±»å†…å®¹æŒç»­çˆ†ç«',
        angle: 'é’ˆå¯¹æ—¶é—´å°‘çš„èŒåœºäººï¼Œæä¾›å¯æ“ä½œçš„å‰¯ä¸šæ—¶é—´ç®¡ç†æ–¹æ¡ˆ',
        title: 'æ¯å¤©30åˆ†é’Ÿå‰¯ä¸šæ—¶é—´ï¼Œæˆ‘æ˜¯æ€ä¹ˆ3ä¸ªæœˆåšåˆ°10ä¸‡ç²‰çš„',
        type: 'æ•™çŸ¥è¯†',
        score: 88,
        scores: { buyer: 92, monetization: 85, unique: 82, trend: 90, feasibility: 90 }
      },
      {
        id: 3,
        event: 'ä¸éœ²è„¸åˆ›ä½œè€…è¶Šæ¥è¶Šå¤š',
        angle: 'ç»™ç¤¾æäººç¾¤ä¸€ä¸ªå¼€å§‹çš„ç†ç”±å’Œæ–¹æ³•',
        title: 'ä¸éœ²è„¸ä¹Ÿèƒ½æœˆå…¥è¿‡ä¸‡ï¼Ÿè¿™3ç§å†…å®¹å½¢å¼æœ€é€‚åˆç¤¾æ',
        type: 'æ™’è¿‡ç¨‹',
        score: 85,
        scores: { buyer: 88, monetization: 82, unique: 85, trend: 80, feasibility: 92 }
      },
      {
        id: 4,
        event: 'AIå·¥å…·æ•ˆç‡é©å‘½',
        angle: 'ç”¨AIæŠŠå†…å®¹ç”Ÿäº§æ•ˆç‡æé«˜10å€',
        title: 'ç”¨AIåšå‰¯ä¸šï¼Œæˆ‘ä¸€ä¸ªäººé¡¶ä¸€ä¸ªå›¢é˜Ÿ',
        type: 'æ•™çŸ¥è¯†',
        score: 83,
        scores: { buyer: 85, monetization: 80, unique: 78, trend: 95, feasibility: 80 }
      },
      {
        id: 5,
        event: '35å²èŒåœºå±æœºè®¨è®ºçƒ­åº¦é«˜',
        angle: '35å²ä¸æ˜¯ç»ˆç‚¹ï¼Œæ˜¯å‰¯ä¸šçš„æœ€ä½³èµ·ç‚¹',
        title: '35å²è¢«ä¼˜åŒ–åï¼Œæˆ‘æ‰¾åˆ°äº†æ¯”ä¸Šç­æ›´ç¨³çš„æ”¶å…¥æ–¹å¼',
        type: 'è®²æ•…äº‹',
        score: 90,
        scores: { buyer: 94, monetization: 88, unique: 86, trend: 93, feasibility: 85 }
      },
      {
        id: 6,
        event: 'çŸ¥è¯†ä»˜è´¹å¸‚åœºæŒç»­å¢é•¿',
        angle: 'ä»æ‰“å·¥äººåˆ°çŸ¥è¯†åšä¸»çš„è½¬å‹è·¯å¾„',
        title: 'æŠŠä½ çš„ä¸“ä¸šå˜æˆè¯¾ç¨‹ï¼Œè¿™æ˜¯æˆ‘è§è¿‡æœ€ç¨³çš„å‰¯ä¸š',
        type: 'èŠè§‚ç‚¹',
        score: 81,
        scores: { buyer: 82, monetization: 92, unique: 75, trend: 78, feasibility: 78 }
      }
    ];
    
    let currentTopics = [];
    let selectedViralElements = [];
    
    const viralElementExamples = {
      'æˆæœ¬çš„': { prefix: '0æˆæœ¬', suffix: '', example: '0æˆæœ¬åšå‡ºç™¾ä¸‡æ’­æ”¾çŸ­è§†é¢‘' },
      'äººç¾¤çš„': { prefix: '', suffix: '', example: '35å²å®å¦ˆäº§åå¿«é€Ÿç˜¦èº«', personas: ['35å²', 'å®å¦ˆ', 'ç¨‹åºå‘˜', 'èŒåœºäºº', 'å¤§å­¦ç”Ÿ', '00å'] },
      'å¥‡è‘©çš„': { prefix: '', suffix: 'çš„ç¦»è°±æ–¹æ³•', example: 'ç”¨AIç”Ÿæˆç™¾ä¸‡æ’­æ”¾è§†é¢‘çš„ç¦»è°±æ–¹æ³•' },
      'æœ€å·®çš„': { prefix: 'çœ‹å®Œ100ä¸ªå¤±è´¥æ¡ˆä¾‹å', suffix: '', example: 'çœ‹å®Œ100ä¸ªå¤±è´¥æ¡ˆä¾‹åæ€»ç»“çš„ç»éªŒ' },
      'åå·®çš„': { prefix: '', suffix: '', example: 'ç¨‹åºå‘˜è½¬å‹çŸ­è§†é¢‘æœˆå…¥10ä¸‡', patterns: ['XXè½¬å‹YY', 'XXå´åœ¨åšYY'] },
      'æ€€æ—§çš„': { prefix: '', suffix: 'è¿˜èƒ½ç”¨å—', example: '5å¹´å‰çš„çŸ­è§†é¢‘å¥—è·¯è¿˜èƒ½ç”¨å—' },
      'è·å°”è’™çš„': { prefix: '', suffix: '', example: 'é¢œå€¼åšä¸»çš„æ¶¨ç²‰ç§˜è¯€', note: 'æ³¨æ„å°ºåº¦' },
      'å¤´ç‰Œçš„': { prefix: 'å­¦ä¹ ', suffix: 'çš„æ–¹æ³•è®º', example: 'å­¦ä¹ è–›è¾‰çš„çŸ­è§†é¢‘æ–¹æ³•è®º' }
    };
    
    function toggleViralElement(el) {
      const element = el.dataset.element;
      
      if (el.classList.contains('selected')) {
        el.classList.remove('selected');
        selectedViralElements = selectedViralElements.filter(e => e !== element);
      } else {
        if (selectedViralElements.length >= 2) {
          const firstSelected = document.querySelector('.viral-element-chip.selected');
          if (firstSelected) {
            firstSelected.classList.remove('selected');
            selectedViralElements.shift();
          }
        }
        el.classList.add('selected');
        selectedViralElements.push(element);
      }
      
      if (selectedViralElements.length > 0 && currentTopics.length > 0) {
        showUpgradePreview();
      } else {
        document.getElementById('topic-upgrade-panel').classList.remove('active');
      }
    }
    
    function showUpgradePreview() {
      const panel = document.getElementById('topic-upgrade-panel');
      const originalTopic = currentTopics[0];
      
      const originalTitle = originalTopic?.title || 'å¦‚ä½•åšå¥½çŸ­è§†é¢‘';
      const originalScore = originalTopic?.score || 62;
      
      document.getElementById('upgrade-original-topic').textContent = originalTitle;
      document.getElementById('original-score').textContent = originalScore + 'åˆ†';
      document.getElementById('original-score-bar').style.width = originalScore + '%';
      
      const enhanced = generateEnhancedTopic(originalTitle, selectedViralElements);
      const scoreBoost = selectedViralElements.length * 12 + Math.floor(Math.random() * 5);
      const enhancedScore = Math.min(98, originalScore + scoreBoost);
      
      document.getElementById('upgrade-enhanced-topic').textContent = enhanced;
      document.getElementById('enhanced-score').textContent = enhancedScore + 'åˆ†';
      document.getElementById('enhanced-score-bar').style.width = enhancedScore + '%';
      
      const elementsContainer = document.getElementById('upgrade-elements-used');
      elementsContainer.innerHTML = selectedViralElements.map(e => 
        `<span class="element-tag">${e}</span>`
      ).join('');
      
      panel.classList.add('active');
    }
    
    function generateEnhancedTopic(original, elements) {
      let enhanced = original;
      
      elements.forEach(element => {
        const config = viralElementExamples[element];
        if (!config) return;
        
        switch(element) {
          case 'æˆæœ¬çš„':
            enhanced = enhanced.replace(/å¦‚ä½•|æ€ä¹ˆ/, '0æˆæœ¬');
            if (!enhanced.includes('0æˆæœ¬')) {
              enhanced = '0æˆæœ¬' + enhanced;
            }
            break;
          case 'äººç¾¤çš„':
            const persona = config.personas[Math.floor(Math.random() * config.personas.length)];
            enhanced = persona + enhanced;
            break;
          case 'åå·®çš„':
            if (enhanced.includes('å‰¯ä¸š') || enhanced.includes('è½¬å‹')) {
              enhanced = enhanced.replace('å‰¯ä¸š', 'ç¨‹åºå‘˜è½¬å‹å‰¯ä¸š');
            } else {
              enhanced = enhanced + 'ï¼Œæ”¶å…¥åè¶…å·¥èµ„';
            }
            break;
          case 'å¥‡è‘©çš„':
            enhanced = enhanced + 'çš„ç¦»è°±æ–¹æ³•';
            break;
          case 'æœ€å·®çš„':
            enhanced = 'çœ‹å®Œ100ä¸ªå¤±è´¥æ¡ˆä¾‹åï¼Œ' + enhanced;
            break;
          case 'æ€€æ—§çš„':
            enhanced = '5å¹´å‰çš„' + enhanced + 'è¿˜èƒ½ç”¨å—';
            break;
          case 'å¤´ç‰Œçš„':
            enhanced = 'å­¦ä¹ è–›è¾‰ï¼š' + enhanced;
            break;
        }
      });
      
      return enhanced;
    }
    
    function closeUpgradePanel() {
      document.getElementById('topic-upgrade-panel').classList.remove('active');
    }
    
    function applyUpgrade() {
      const enhancedTitle = document.getElementById('upgrade-enhanced-topic').textContent;
      const enhancedScore = parseInt(document.getElementById('enhanced-score').textContent);
      
      if (currentTopics.length > 0) {
        currentTopics[0] = {
          ...currentTopics[0],
          title: enhancedTitle,
          score: enhancedScore,
          viralElements: [...selectedViralElements]
        };
        renderTopics(currentTopics);
        closeUpgradePanel();
        
        selectedViralElements = [];
        document.querySelectorAll('.viral-element-chip.selected').forEach(el => {
          el.classList.remove('selected');
        });
      }
    }
    
    function regenerateUpgrade() {
      showUpgradePreview();
    }
    
    function loadContext() {
      const profile = localStorage.getItem('creatorOS_profile');
      const contextTags = document.getElementById('context-tags');
      
      if (profile) {
        const data = JSON.parse(profile);
        const tags = [];
        
        if (data.buyer?.persona) tags.push(`ä¹°å®¶: ${data.buyer.persona.substring(0, 20)}...`);
        if (data.monetization?.model) tags.push(`å˜ç°: ${data.monetization.model}`);
        if (data.content?.pillars?.length) tags.push(`æ”¯æŸ±: ${data.content.pillars.slice(0, 2).join(', ')}`);
        if (data.buyer?.painPoints?.length) tags.push(`ç—›ç‚¹: ${data.buyer.painPoints.slice(0, 2).join(', ')}`);
        
        if (tags.length > 0) {
          contextTags.innerHTML = tags.map(t => `<span class="context-tag">${t}</span>`).join('');
        } else {
          contextTags.innerHTML = '<span class="context-tag">è¯·å…ˆå®Œæˆè®¾ç½®å‘å¯¼</span>';
        }
      } else {
        contextTags.innerHTML = '<span class="context-tag">æœªé…ç½® - <a href="setup-wizard.html">å»è®¾ç½®</a></span>';
      }
    }
    
    function setWorkflowStep(step) {
      document.querySelectorAll('.workflow-step').forEach(el => {
        el.classList.remove('active', 'completed');
      });
      
      const steps = ['collect', 'generate', 'review', 'output'];
      const currentIndex = steps.indexOf(step);
      
      steps.forEach((s, i) => {
        const el = document.querySelector(`[data-step="${s}"]`);
        if (i < currentIndex) {
          el.classList.add('completed');
        } else if (i === currentIndex) {
          el.classList.add('active');
        }
      });
    }
    
    function setStatus(status, text) {
      const indicator = document.getElementById('status-indicator');
      const statusText = document.getElementById('status-text');
      
      indicator.classList.remove('generating');
      if (status === 'generating') {
        indicator.classList.add('generating');
      }
      statusText.textContent = text;
    }
    
    async function generateTopics() {
      const btn = document.getElementById('generate-btn');
      btn.disabled = true;
      btn.textContent = 'ç”Ÿæˆä¸­...';
      
      setStatus('generating', 'é‡‡é›†çƒ­ç‚¹...');
      setWorkflowStep('collect');
      await sleep(800);
      
      setStatus('generating', 'ç”Ÿæˆé€‰é¢˜...');
      setWorkflowStep('generate');
      await sleep(1200);
      
      setStatus('generating', 'è¯„åˆ†å®¡æ ¸...');
      setWorkflowStep('review');
      await sleep(1000);
      
      setStatus('ready', 'å®Œæˆ');
      setWorkflowStep('output');
      
      currentTopics = [...sampleTopics];
      renderTopics(currentTopics);
      
      btn.disabled = false;
      btn.textContent = 'ğŸ¯ é‡æ–°ç”Ÿæˆ';
    }
    
    function renderTopics(topics) {
      const grid = document.getElementById('topics-grid');
      
      if (topics.length === 0) {
        grid.innerHTML = `
          <div class="empty-state">
            <div class="empty-state-icon">ğŸ”</div>
            <h3>æ²¡æœ‰åŒ¹é…çš„é€‰é¢˜</h3>
            <p>å°è¯•å…¶ä»–ç­›é€‰æ¡ä»¶</p>
          </div>
        `;
        return;
      }
      
      grid.innerHTML = topics.map(topic => `
        <div class="topic-card" data-id="${topic.id}" data-type="${topic.type}" data-score="${topic.score}">
          <div class="topic-card-header">
            <div class="topic-badge-group">
              <span class="topic-score-badge ${getScoreClass(topic.score)}">${topic.score}åˆ†</span>
              <span class="topic-type-badge">${topic.type}</span>
              ${topic.viralElements ? topic.viralElements.map(e => `<span class="topic-type-badge" style="background: rgba(0, 212, 170, 0.1); color: var(--color-secondary);">ğŸ”¥${e}</span>`).join('') : ''}
            </div>
          </div>
          <div class="topic-event">ğŸ“° ${topic.event}</div>
          <div class="topic-title">${topic.title}</div>
          <div class="topic-angle">ğŸ’¡ ${topic.angle}</div>
          <div class="topic-scores">
            <div class="score-item">
              <div class="score-item-value">${topic.scores.buyer}</div>
              <div class="score-item-label">ä¹°å®¶åŒ¹é…</div>
            </div>
            <div class="score-item">
              <div class="score-item-value">${topic.scores.monetization}</div>
              <div class="score-item-label">å˜ç°å…³è”</div>
            </div>
            <div class="score-item">
              <div class="score-item-value">${topic.scores.unique}</div>
              <div class="score-item-label">å·®å¼‚åŒ–</div>
            </div>
            <div class="score-item">
              <div class="score-item-value">${topic.scores.trend}</div>
              <div class="score-item-label">çƒ­åº¦æ—¶æ•ˆ</div>
            </div>
            <div class="score-item">
              <div class="score-item-value">${topic.scores.feasibility}</div>
              <div class="score-item-label">å¯æ‰§è¡Œ</div>
            </div>
          </div>
          <div class="topic-actions">
            <button class="btn btn-primary" onclick="selectTopic(${topic.id})">é€‰æ‹©å¹¶ç”Ÿæˆè„šæœ¬</button>
            <button class="btn btn-ghost" onclick="upgradeTopic(${topic.id})">ğŸ”¥ çˆ†æ¬¾å‡çº§</button>
            <button class="btn btn-ghost" onclick="saveTopic(${topic.id})">â­ å½’æ¡£</button>
          </div>
        </div>
      `).join('');
    }
    
    function getScoreClass(score) {
      if (score >= 85) return 'score-high';
      if (score >= 70) return 'score-medium';
      return 'score-low';
    }
    
    function filterTopics(filter, btn) {
      document.querySelectorAll('.filter-chip').forEach(c => c.classList.remove('active'));
      btn.classList.add('active');
      
      let filtered = currentTopics;
      
      if (filter === 'high') {
        filtered = currentTopics.filter(t => t.score >= 80);
      } else if (filter !== 'all') {
        filtered = currentTopics.filter(t => t.type === filter);
      }
      
      renderTopics(filtered);
    }
    
    function selectTopic(id) {
      const topic = currentTopics.find(t => t.id === id);
      if (topic) {
        localStorage.setItem('creatorOS_selectedTopic', JSON.stringify(topic));
        window.location.href = 'script-generator.html';
      }
    }
    
    function upgradeTopic(id) {
      const topic = currentTopics.find(t => t.id === id);
      if (topic) {
        const index = currentTopics.indexOf(topic);
        currentTopics.unshift(currentTopics.splice(index, 1)[0]);
        
        document.getElementById('viral-elements-grid').scrollIntoView({ behavior: 'smooth' });
        
        const panel = document.getElementById('topic-upgrade-panel');
        document.getElementById('upgrade-original-topic').textContent = topic.title;
        document.getElementById('original-score').textContent = topic.score + 'åˆ†';
        document.getElementById('original-score-bar').style.width = topic.score + '%';
        
        if (selectedViralElements.length > 0) {
          showUpgradePreview();
        }
      }
    }
    
    function saveTopic(id) {
      const topic = currentTopics.find(t => t.id === id);
      if (topic) {
        const archived = JSON.parse(localStorage.getItem('creatorOS_archivedTopics') || '[]');
        const exists = archived.some(t => t.title === topic.title);
        if (exists) {
          alert('è¯¥é€‰é¢˜å·²å½’æ¡£ï¼');
          return;
        }
        archived.unshift({
          id: Date.now(),
          title: topic.title,
          type: topic.type,
          angle: topic.angle,
          event: topic.event,
          score: topic.score,
          scores: topic.scores,
          archivedAt: new Date().toISOString()
        });
        localStorage.setItem('creatorOS_archivedTopics', JSON.stringify(archived));
        alert('å·²å½’æ¡£åˆ°ç´ æåº“ï¼å¯åœ¨ç´ æåº“æŸ¥çœ‹ã€‚');
      }
    }
    
    function sleep(ms) {
      return new Promise(resolve => setTimeout(resolve, ms));
    }
    
    loadContext();
  </script>
</body>
</html>
